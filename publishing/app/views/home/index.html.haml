- if Course.current
  - @course = Course.current
  %div.container
    %div.row
      %div.col-md-8.col-md-offset-2
        %h1
          = @course.name
      %div.col-md-2
        = link_to 'Publish', publish_course_path, class: "btn btn-lg btn-success", method: :post
    -# %div.row{style: "margin-top:10px;"}
    -#   %div.col-md-8.col-md-offset-2
    -#     %h3
    -#       = link_to 'Entry test questions', questions_path
    -#       %small= "(#{ @course.questions.length } questions)"
    -#     %table.table.table-bordered
    -#       %thead
    -#         %tr
    -#           %th Question
    -#       %tbody
    -#         - @course.questions.each do |question|
    -#           %tr{class: question.active? ? "success" : "danger"}
    -#             %td= link_to question.to_s.truncate(90, omission: '...'), edit_question_path(question)

    - errors = @course.errors_when_publishing
    - unless errors.empty?
      %div.row
        %div.alert.alert-danger.col-md-8.col-md-offset-2
          %ul
            - errors.each do |error|
              %li= error

    %div.row{style: "margin-top:10px;"}
      %div.col-md-8.col-md-offset-2
        %h3
          = link_to 'Chapters', chapters_path
          %small= "(#{ @course.chapters.length } chapters)"
        - @course.chapters.each do |chapter|
          %div.panel{class: chapter.active? ? "panel-success" : "panel-danger"}
            %div.panel-heading
              %h4= link_to chapter.title, chapter
            %div.panel-body.success
              %table.table.table-bordered
                %thead
                  %tr
                    %th{colspan: 2}
                      Section
                      %span.pull-right
                        = "#{chapter.sections.active.length} / #{chapter.sections.length} published"
                    %th
                      %span.pull-right # subsections
                    %th
                      %span.pull-right # questions
                %tbody
                  - chapter.sections.each_with_index do |section, index|
                    %tr{class: section.active? ? "success" : "danger", id: "section-row"}
                      %td= index + 1
                      %td
                        = link_to section.title, [chapter, section]
                      %td
                        %span.label.label-primary.pull-right
                          = "#{section.subsections.length}"
                      %td
                        %span.label.label-success.pull-right= section.questions.length
      %div.col-md-2
        %strong Guide:
        %table.table.table-condensed.table-bordered
          %tr
            %td.success Element active
            %tr
            %td.danger Element not active
- else
  %div.container
    %div.alert.alert-warning Please select a course from the dropdown on the top right.
